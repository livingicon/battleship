(()=>{"use strict";class e{constructor(e,t,l,i,s=0){this.id=e,this.side=t,this.name=l,this.location=i,this.length=i.length,this.hits=s}hit(){this.hits++}isSunk(e){this.length===this.hits&&h(this.name,e)}}class t{constructor(){this.totalHits=0,this.waterGrid=[]}createGameboard(){for(let e=1;e<=100;e++)this.waterGrid.push({cell:e,hit:0,miss:0});return this.waterGrid}placeShip(t,l,i,s,n=0){let r;r=new e(t,0===l?0:1,i,s,n),w(l,r)}receiveAttack(e,t){let l;l=t===k?E:I;for(let i=0;i<l.length;i++)for(let n=0;n<l[i].location.length;n++)e===l[i].location[n]&&(t.waterGrid[e-1].hit=1,l[i].hit(),l[i].isSunk(t),t.allSunk(t),l===E&&(s=[],s.push(t.waterGrid[e-1].cell)));0===t.waterGrid[e-1].hit&&(t.waterGrid[e-1].miss=1),o(t)}allSunk(e){for(let t=0;t<100;t++)1===e.waterGrid[t].hit&&e.totalHits++;17===e.totalHits?(a(),u(e)):17!==e.totalHits&&(e.totalHits=0)}}class l{constructor(e){this.player=e}playerAttack(e){let t=Number(e.target.getAttribute("data-compcell"));1===B.waterGrid[t-1].hit||1===B.waterGrid[t-1].miss||(B.receiveAttack(t,B),0===B.totalHits&&A.computerAttack(k))}computerAttack(e){const t=Math.floor(100*Math.random())+1;if(1===s.length)if(n.push(s[0]-10,s[0]-1,s[0]+1,s[0]+10),r(n),0===n.length)s=[],A.computerAttack(k);else{const t=n[Math.floor(Math.random()*n.length)];n=[],e.receiveAttack(t,e)}else 1===e.waterGrid[t-1].hit||1===e.waterGrid[t-1].miss?A.computerAttack(k):e.receiveAttack(t,e)}}document.getElementById("gameBoards");let s=[],n=[];const r=e=>{s[0]%10==0&&e.splice(2,1),s[0]%10==1&&e.splice(1,1);for(let t=e.length-1;t>=0;t--)(e[t]<=0||e[t]>100||1===k.waterGrid[e[t]-1].hit||1===k.waterGrid[e[t]-1].miss)&&e.splice(e.indexOf(e[t]),1)},a=()=>{document.querySelectorAll(".compCell").forEach((e=>{e.removeEventListener("click",S.playerAttack)}))},d=(e,t,l,i)=>{if(!0!==c(e,i)&&!0!==f(i,1))B.placeShip(t,1,l,i);else{if(1===e){let s=i.length,n=Math.floor(100*Math.random())+1;i=[n];for(let e=1;e<s;e++)i.push(n+e);d(e,t,l,i)}if(2===e){let s=i.length,n=Math.floor(100*Math.random())+1;i=[n];for(let e=1;e<s;e++)i.push(n+10*e);d(e,t,l,i)}}},c=(e,t)=>2===e&&Math.max(...t)>100||!(1!==e||!(t.includes(10)&&t.includes(11)||t.includes(20)&&t.includes(21)||t.includes(30)&&t.includes(31)||t.includes(40)&&t.includes(41)||t.includes(50)&&t.includes(51)||t.includes(60)&&t.includes(61)||t.includes(70)&&t.includes(71)||t.includes(80)&&t.includes(81)||t.includes(90)&&t.includes(91)||t.includes(101)))||void 0,o=e=>{let t;t=e===k?"playcell":"compcell";for(let l=0;l<100;l++)1===e.waterGrid[l].hit&&document.querySelector(`[data-${t}='${l+1}']`).classList.add("hit"),1===e.waterGrid[l].miss&&document.querySelector(`[data-${t}='${l+1}']`).classList.add("miss")},h=(e,t)=>{let l;l=t===B?"comp":"play",document.getElementById(`${l}${e}`).classList.add("sunk")},u=e=>{const t=document.getElementById("info"),l=document.getElementById("instructions"),i=document.createElement("button");i.innerHTML="RESET",i.addEventListener("click",m),t.removeChild(l),t.appendChild(i),e===k?(document.getElementById("enemyStatus").innerHTML="ENEMY STATUS: You are VICTORIOUS!",document.getElementById("playerStatus").innerHTML="PLAYER STATUS: Your Fleet Lies in RUIN!"):(document.getElementById("playerStatus").innerHTML="PLAYER STATUS: You are VICTORIOUS!",document.getElementById("enemyStatus").innerHTML="ENEMY STATUS: Your Fleet Lies in RUIN!")},m=()=>location.reload();let p=[];document.getElementById("directionBtn").addEventListener("click",(function(){const e=document.querySelectorAll(".dragShip"),t=document.getElementById("Carrier"),l=getComputedStyle(t).width,i=document.getElementById("Battleship"),s=document.getElementById("Cruiser"),n=document.getElementById("Submarine"),r=document.getElementById("Destroyer");""===fleet.style.display?(document.getElementById("fleet").style.display="flex",e.forEach((e=>{e.style.display="block"})),t&&(t.style.width=`${l}`,t.style.height=5*parseInt(l)+"px"),i&&(i.style.width=`${l}`,i.style.height=4*parseInt(l)+"px"),s&&(s.style.width=`${l}`,s.style.height=3*parseInt(l)+"px"),n&&(n.style.width=`${l}`,n.style.height=3*parseInt(l)+"px"),r&&(r.style.width=`${l}`,r.style.height=2*parseInt(l)+"px")):(fleet.style.display="block")&&(document.getElementById("fleet").style.display="",e.forEach((e=>{e.style.display="flex"})),t&&(t.style.width=5*parseInt(l)+"px",t.style.height=`${l}`),i&&(i.style.width=4*parseInt(l)+"px",i.style.height=`${l}`),s&&(s.style.width=3*parseInt(l)+"px",s.style.height=`${l}`),n&&(n.style.width=3*parseInt(l)+"px",n.style.height=`${l}`),r&&(r.style.width=2*parseInt(l)+"px",r.style.height=`${l}`))}));const y=e=>{e.dataTransfer.setData("text/plain",e.target.id)},g=e=>{p.push(e.target.getAttribute("data-cell"))},f=(e,t)=>{let l;for(l=0===t?E:I,i=0;i<l.length;i++)for(let t=0;t<l[i].location.length;t++)if(-1!==e.indexOf(l[i].location[t]))return!0},E=[],I=[],w=(e,t)=>{let l;l=0===e?E:I,0===l.length?l.push(t):0!==l.length&&(l.push(t),l.sort((function(e,t){return e.id-t.id})))},S=new l,A=new l,k=new t,B=new t;k.createGameboard(),B.createGameboard(),(()=>{const e=[[0,"Carrier",4],[1,"Battleship",3],[2,"Cruiser",2],[3,"Submarine",2],[4,"Destroyer",1]];for(let t=0;t<e.length;t++){let l=t,i=e[t][1],s=[];const n=Math.floor(2*Math.random())+1,r=Math.floor(100*Math.random())+1;if(s.push(r),1===n){for(let l=1;l<=e[t][2];l++)s.push(r+l);d(n,l,i,s)}if(2===n){for(let l=1;l<=e[t][2];l++)s.push(r+10*l);d(n,l,i,s)}}})(),document.querySelectorAll(".dragCell").forEach((e=>{e.addEventListener("mousedown",g)})),document.querySelectorAll(".dragShip").forEach((e=>{e.addEventListener("dragstart",y)})),(()=>{const e=document.getElementById("player"),t=document.getElementById("computer");for(let l=1;l<=100;l++){const i=document.createElement("div");i.classList.add("playCell"),i.setAttribute("data-playcell",l),e.appendChild(i);const s=document.createElement("div");s.classList.add("compCell"),s.setAttribute("data-compcell",l),t.appendChild(s),document.querySelectorAll(".compCell").forEach((e=>{e.addEventListener("click",S.playerAttack)}))}})()})();