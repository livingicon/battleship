(()=>{"use strict";const e=(()=>{document.getElementById("gameBoards");const e=[],t=[],l=document.getElementById("directionBtn"),r=document.getElementById("player");let i=[];l.addEventListener("click",(()=>{const e=document.querySelectorAll(".dragShip"),t=document.getElementById("Carrier"),l=getComputedStyle(t).height,r=document.getElementById("Battleship"),i=document.getElementById("Cruiser"),s=document.getElementById("Submarine"),a=document.getElementById("Destroyer");if(""===fleet.style.display){if(document.getElementById("fleet").style.display="flex",e.forEach((e=>{e.style.display="block",e.setAttribute("data-measure",l)})),t){let e=t.getAttribute("data-measure");t.style.width=`${e}`,t.style.height=5*parseInt(e)+"px"}if(r){let e=r.getAttribute("data-measure");r.style.width=`${e}`,r.style.height=4*parseInt(e)+"px"}if(i){let e=i.getAttribute("data-measure");i.style.width=`${e}`,i.style.height=3*parseInt(e)+"px"}if(s){let e=s.getAttribute("data-measure");s.style.width=`${e}`,s.style.height=3*parseInt(e)+"px"}if(a){let e=a.getAttribute("data-measure");a.style.width=`${e}`,a.style.height=2*parseInt(e)+"px"}}else if(fleet.style.display="block"){if(document.getElementById("fleet").style.display="",e.forEach((e=>{e.style.display="flex",e.setAttribute("data-measure",l)})),t){let e=t.getAttribute("data-measure");t.style.width=`${e}`,t.style.height=parseInt(e)/5+"px"}if(r){let e=r.getAttribute("data-measure");r.style.width=parseInt(e)/5*4+"px",r.style.height=parseInt(e)/5+"px"}if(i){let e=i.getAttribute("data-measure");i.style.width=parseInt(e)/5*3+"px",i.style.height=parseInt(e)/5+"px"}if(s){let e=s.getAttribute("data-measure");s.style.width=parseInt(e)/5*3+"px",s.style.height=parseInt(e)/5+"px"}if(a){let e=a.getAttribute("data-measure");a.style.width=parseInt(e)/5*2+"px",a.style.height=parseInt(e)/5+"px"}}})),r.addEventListener("dragover",(function(e){e.preventDefault()})),r.addEventListener("dragenter",(function(e){e.preventDefault()})),r.addEventListener("drop",(function(e){if(i.length>1)for(let e=i.length-2;e>=0;e--)i.splice(i.indexOf(i[e]),1);const t=e.dataTransfer.getData("text"),l=e.target;i.push(l.getAttribute("data-playcell")),i.push(t),n(t)}));const s=e=>{e.dataTransfer.setData("text/plain",e.target.id)},a=e=>{i.push(e.target.getAttribute("data-cell"))},n=t=>{const l=document.getElementById("fleet");let r,s,a=i[2],n=[Number(i[1])];if("Carrier"===i[2]&&(r=0,s=5),"Battleship"===i[2]&&(r=1,s=4),"Cruiser"===i[2]&&(r=2,s=3),"Submarine"===i[2]&&(r=3,s=3),"Destroyer"===i[2]&&(r=4,s=2),""===l.style.display){let e=s-i[0],t=i[0]-1;for(let t=1;t<=e;t++)n.push(Number(i[1])+t);for(let e=1;e<=t;e++)n.unshift(Number(i[1])-e)}else if("flex"===l.style.display){let e=i[0]-1,t=s-i[0];for(let t=1;t<=e;t++)n.unshift(Number(i[1])-10*t);for(let e=1;e<=t;e++)n.push(Number(i[1])+10*e)}c(n)&&!0!==d(n,0)?(document.getElementById(t).remove(),playerGrid.placeShip(r,0,a,n),i=[],h(),(()=>{const t=document.getElementById("playerBattle"),l=document.getElementById("computerArea"),r=document.getElementById("instructions"),i=document.getElementById("harbor"),s=document.getElementById("directionBtn"),a=document.getElementById("key");5===e.length&&(t.style.display="block",l.style.display="block",a.style.display="block",r.innerHTML="Attack the enemy fleet by clicking on their waters.",i.style.display="none",s.style.display="none")})()):(i=[],h())},d=(l,r)=>{let i;i=0===r?e:t;for(let e=0;e<i.length;e++)for(let t=0;t<i[e].location.length;t++)if(-1!==l.indexOf(i[e].location[t]))return!0},c=(e,t)=>{const l=document.getElementById("fleet");return""===l.style.display?!(e.includes(0)||e.includes(10)&&e.includes(11)||e.includes(20)&&e.includes(21)||e.includes(30)&&e.includes(31)||e.includes(40)&&e.includes(41)||e.includes(50)&&e.includes(51)||e.includes(60)&&e.includes(61)||e.includes(70)&&e.includes(71)||e.includes(80)&&e.includes(81)||e.includes(90)&&e.includes(91)||e.includes(101)):"flex"===l.style.display?!(Math.min(...e)<1||Math.max(...e)>100):void 0},o=(e,t,l,r,i)=>{if(!0!==u(e,r)&&!0!==d(r,1))i.placeShip(t,1,l,r);else{if(1===e){let s=r.length,a=Math.floor(100*Math.random())+1;r=[a];for(let e=1;e<s;e++)r.push(a+e);o(e,t,l,r,i)}if(2===e){let s=r.length,a=Math.floor(100*Math.random())+1;r=[a];for(let e=1;e<s;e++)r.push(a+10*e);o(e,t,l,r,i)}}},u=(e,t)=>2===e&&Math.max(...t)>100||!(1!==e||!(t.includes(10)&&t.includes(11)||t.includes(20)&&t.includes(21)||t.includes(30)&&t.includes(31)||t.includes(40)&&t.includes(41)||t.includes(50)&&t.includes(51)||t.includes(60)&&t.includes(61)||t.includes(70)&&t.includes(71)||t.includes(80)&&t.includes(81)||t.includes(90)&&t.includes(91)||t.includes(101)))||void 0,h=()=>{for(let t=0;t<e.length;t++)for(let l=0;l<e[t].location.length;l++)document.querySelector(`[data-playcell='${e[t].location[l]}']`).classList.add("ship")};return{renderGrids:()=>{const e=document.getElementById("player"),t=document.getElementById("computer");for(let l=1;l<=100;l++){const r=document.createElement("div");r.classList.add("playCell"),r.setAttribute("data-playcell",l),e.appendChild(r);const i=document.createElement("div");i.classList.add("compCell"),i.setAttribute("data-compcell",l),t.appendChild(i)}},placeComputerShip:e=>{const t=[[0,"Carrier",4],[1,"Battleship",3],[2,"Cruiser",2],[3,"Submarine",2],[4,"Destroyer",1]];for(let l=0;l<t.length;l++){let r=l,i=t[l][1],s=[],a=e;const n=Math.floor(2*Math.random())+1,d=Math.floor(100*Math.random())+1;if(s.push(d),1===n){for(let e=1;e<=t[l][2];e++)s.push(d+e);o(n,r,i,s,a)}if(2===n){for(let e=1;e<=t[l][2];e++)s.push(d+10*e);o(n,r,i,s,a)}}},addDragListeners:()=>{document.querySelectorAll(".dragCell").forEach((e=>{e.addEventListener("mousedown",a)})),document.querySelectorAll(".dragShip").forEach((e=>{e.addEventListener("dragstart",s)}))},logFleet:(l,r)=>{let i;i=0===l?e:t,0===i.length?i.push(r):0!==i.length&&(i.push(r),i.sort((function(e,t){return e.id-t.id})))},addListeners:()=>{document.querySelectorAll(".compCell").forEach((e=>{e.addEventListener("click",human.playerAttack)}))},removeListeners:()=>{document.querySelectorAll(".compCell").forEach((e=>{e.removeEventListener("click",human.playerAttack)}))}}})(),t=e,l=class{constructor(e){this.player=e}playerAttack(e){let t=Number(e.target.getAttribute("data-compcell"));1===computerGrid.waterGrid[t-1].hit||1===computerGrid.waterGrid[t-1].miss||(computerGrid.receiveAttack(t,computerGrid),0===computerGrid.totalHits&&computer.computerAttack(playerGrid))}computerAttack(e){const t=Math.floor(100*Math.random())+1;if(1===loggedHitAI.length)if(smartHits.push(loggedHitAI[0]-10,loggedHitAI[0]-1,loggedHitAI[0]+1,loggedHitAI[0]+10),checkSmartHits(smartHits),0===smartHits.length)loggedHitAI=[],computer.computerAttack(playerGrid);else{const t=smartHits[Math.floor(Math.random()*smartHits.length)];smartHits=[],e.receiveAttack(t,e)}else 1===e.waterGrid[t-1].hit||1===e.waterGrid[t-1].miss?computer.computerAttack(playerGrid):e.receiveAttack(t,e)}},r=class{constructor(){this.totalHits=0,this.waterGrid=[]}createGameboard(){for(let e=1;e<=100;e++)this.waterGrid.push({cell:e,hit:0,miss:0});return this.waterGrid}placeShip(e,l,r,s,a=0){let n;n=new i(e,0===l?0:1,r,s,a),t.logFleet(l,n)}receiveAttack(e,l){let r;r=l===playerGrid?t.playerFleet:t.enemyFleet;for(let i=0;i<r.length;i++)for(let s=0;s<r[i].location.length;s++)e===r[i].location[s]&&(l.waterGrid[e-1].hit=1,r[i].hit(),r[i].isSunk(l),l.allSunk(l),r===t.playerFleet&&(loggedHitAI=[],loggedHitAI.push(l.waterGrid[e-1].cell)));0===l.waterGrid[e-1].hit&&(l.waterGrid[e-1].miss=1),t.hitOrMiss(l)}allSunk(e){for(let t=0;t<100;t++)1===e.waterGrid[t].hit&&e.totalHits++;17===e.totalHits?(t.removeListeners(human),t.gameOver(e)):17!==e.totalHits&&(e.totalHits=0)}},i=class{constructor(e,t,l,r,i=0){this.id=e,this.side=t,this.name=l,this.location=r,this.length=r.length,this.hits=i}hit(){this.hits++}isSunk(e){this.length===this.hits&&sunk(this.name,e)}},s=(new l,new l,new r),a=new r;s.createGameboard(),a.createGameboard(),t.addListeners(),t.placeComputerShip(a),t.addDragListeners(),t.renderGrids()})();