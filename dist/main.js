(()=>{class e{constructor(e,t,l,i,n=0){this.id=e,this.side=t,this.name=l,this.location=i,this.length=i.length,this.hits=n}hit(){this.hits++}isSunk(e){this.length===this.hits&&h(this.name,e)}}class t{constructor(){this.totalHits=0,this.waterGrid=[]}createGameboard(){for(let e=1;e<=100;e++)this.waterGrid.push({cell:e,hit:0,miss:0});return this.waterGrid}placeShip(t,l,i,n,s=0){let d;d=new e(t,0===l?0:1,i,n,s),A(l,d)}receiveAttack(e,t){let l;l=t===L?w:b;for(let i=0;i<l.length;i++)for(let s=0;s<l[i].location.length;s++)e===l[i].location[s]&&(t.waterGrid[e-1].hit=1,l[i].hit(),l[i].isSunk(t),t.allSunk(t),l===w&&(n=[],n.push(t.waterGrid[e-1].cell)));0===t.waterGrid[e-1].hit&&(t.waterGrid[e-1].miss=1),o(t)}allSunk(e){for(let t=0;t<100;t++)1===e.waterGrid[t].hit&&e.totalHits++;17===e.totalHits?(r(),m(e)):17!==e.totalHits&&(e.totalHits=0)}}class l{constructor(e){this.player=e}playerAttack(e){let t=Number(e.target.getAttribute("data-compcell"));1===v.waterGrid[t-1].hit||1===v.waterGrid[t-1].miss||(v.receiveAttack(t,v),0===v.totalHits&&C.computerAttack(L))}computerAttack(e){const t=Math.floor(100*Math.random())+1;if(1===n.length)if(s.push(n[0]-10,n[0]-1,n[0]+1,n[0]+10),d(s),0===s.length)n=[],C.computerAttack(L);else{const t=s[Math.floor(Math.random()*s.length)];s=[],e.receiveAttack(t,e)}else 1===e.waterGrid[t-1].hit||1===e.waterGrid[t-1].miss?C.computerAttack(L):e.receiveAttack(t,e)}}document.getElementById("gameBoards");let n=[],s=[];const d=e=>{n[0]%10==0&&e.splice(2,1),n[0]%10==1&&e.splice(1,1);for(let t=e.length-1;t>=0;t--)(e[t]<=0||e[t]>100||1===L.waterGrid[e[t]-1].hit||1===L.waterGrid[e[t]-1].miss)&&e.splice(e.indexOf(e[t]),1)},r=()=>{document.querySelectorAll(".compCell").forEach((e=>{e.removeEventListener("click",k.playerAttack)}))},a=(e,t,l,i)=>{if(!0!==c(e,i)&&!0!==I(i,1))v.placeShip(t,1,l,i);else{if(1===e){let n=i.length,s=Math.floor(100*Math.random())+1;i=[s];for(let e=1;e<n;e++)i.push(s+e);a(e,t,l,i)}if(2===e){let n=i.length,s=Math.floor(100*Math.random())+1;i=[s];for(let e=1;e<n;e++)i.push(s+10*e);a(e,t,l,i)}}},c=(e,t)=>2===e&&Math.max(...t)>100||!(1!==e||!(t.includes(10)&&t.includes(11)||t.includes(20)&&t.includes(21)||t.includes(30)&&t.includes(31)||t.includes(40)&&t.includes(41)||t.includes(50)&&t.includes(51)||t.includes(60)&&t.includes(61)||t.includes(70)&&t.includes(71)||t.includes(80)&&t.includes(81)||t.includes(90)&&t.includes(91)||t.includes(101)))||void 0,o=e=>{let t;t=e===L?"playcell":"compcell";for(let l=0;l<100;l++)1===e.waterGrid[l].hit&&document.querySelector(`[data-${t}='${l+1}']`).classList.add("hit"),1===e.waterGrid[l].miss&&document.querySelector(`[data-${t}='${l+1}']`).classList.add("miss")},u=()=>{for(i=0;i<w.length;i++)for(let e=0;e<w[i].location.length;e++)document.querySelector(`[data-playcell='${w[i].location[e]}']`).classList.add("ship")},h=(e,t)=>{let l;l=t===v?"comp":"play",document.getElementById(`${l}${e}`).classList.add("sunk")},m=e=>{const t=document.getElementById("info"),l=document.getElementById("instructions"),i=document.createElement("button");i.innerHTML="RESET",i.addEventListener("click",y),t.removeChild(l),t.appendChild(i),e===L?(document.getElementById("enemyStatus").innerHTML="ENEMY STATUS: You are VICTORIOUS!",document.getElementById("playerStatus").innerHTML="PLAYER STATUS: Your Fleet Lies in RUIN!"):(document.getElementById("playerStatus").innerHTML="PLAYER STATUS: You are VICTORIOUS!",document.getElementById("enemyStatus").innerHTML="ENEMY STATUS: Your Fleet Lies in RUIN!")},y=()=>location.reload();let p=[];document.getElementById("directionBtn").addEventListener("click",(function(){const e=document.querySelectorAll(".dragShip"),t=document.getElementById("Carrier"),l=document.getElementById("Battleship"),i=document.getElementById("Cruiser"),n=document.getElementById("Submarine"),s=document.getElementById("Destroyer");if(""===fleet.style.display){if(document.getElementById("fleet").style.display="flex",e.forEach((e=>{e.style.display="block"})),t){const e=getComputedStyle(t).carWidth;t.style.width=`${e}`,t.style.height=5*parseInt(e)+"px"}if(l){const e=getComputedStyle(l).batWidth;l.style.width=`${e}`,l.style.height=4*parseInt(e)+"px"}if(i){const e=getComputedStyle(i).cruisWidth;i.style.width=`${e}`,i.style.height=3*parseInt(e)+"px"}if(n){const e=getComputedStyle(n).subWidth;n.style.width=`${e}`,n.style.height=3*parseInt(e)+"px"}if(s){const e=getComputedStyle(s).destWidth;s.style.width=`${e}`,s.style.height=2*parseInt(e)+"px"}}else if(fleet.style.display="block"){if(document.getElementById("fleet").style.display="",e.forEach((e=>{e.style.display="flex"})),t){const e=getComputedStyle(t).carWidth;t.style.width=5*parseInt(e)+"px",t.style.height=`${e}`}if(l){const e=getComputedStyle(l).batWidth;l.style.width=4*parseInt(e)+"px",l.style.height=`${e}`}if(i){const e=getComputedStyle(i).cruisWidth;i.style.width=3*parseInt(e)+"px",i.style.height=`${e}`}if(n){const e=getComputedStyle(n).subWidth;n.style.width=3*parseInt(e)+"px",n.style.height=`${e}`}if(s){const e=getComputedStyle(s).destWidth;s.style.width=2*parseInt(e)+"px",s.style.height=`${e}`}}}));const g=document.getElementById("player");g.addEventListener("dragover",(function(e){e.preventDefault()})),g.addEventListener("dragenter",(function(e){e.preventDefault()})),g.addEventListener("drop",(function(e){if(p.length>1)for(let e=p.length-2;e>=0;e--)p.splice(p.indexOf(p[e]),1);const t=e.dataTransfer.getData("text"),l=e.target;p.push(l.getAttribute("data-playcell")),p.push(t),S(t)}));const f=e=>{e.dataTransfer.setData("text/plain",e.target.id)},E=e=>{p.push(e.target.getAttribute("data-cell"))},S=e=>{const t=document.getElementById("fleet");let l,i,n=p[2],s=[Number(p[1])];if("Carrier"===p[2]&&(l=0,i=5),"Battleship"===p[2]&&(l=1,i=4),"Cruiser"===p[2]&&(l=2,i=3),"Submarine"===p[2]&&(l=3,i=3),"Destroyer"===p[2]&&(l=4,i=2),""===t.style.display){let e=i-p[0],t=p[0]-1;for(let t=1;t<=e;t++)s.push(Number(p[1])+t);for(let e=1;e<=t;e++)s.unshift(Number(p[1])-e)}else if("flex"===t.style.display){let e=p[0]-1,t=i-p[0];for(let t=1;t<=e;t++)s.unshift(Number(p[1])-10*t);for(let e=1;e<=t;e++)s.push(Number(p[1])+10*e)}B(s)&&!0!==I(s,0)?(document.getElementById(e).remove(),L.placeShip(l,0,n,s),p=[],u(),(()=>{const e=document.getElementById("playerBattle"),t=document.getElementById("computerArea"),l=document.getElementById("instructions"),i=document.getElementById("harbor"),n=document.getElementById("directionBtn"),s=document.getElementById("key");5===w.length&&(e.style.display="block",t.style.display="block",s.style.display="block",l.innerHTML="Attack the enemy fleet by clicking on their waters.",i.style.display="none",n.style.display="none")})()):(p=[],u())},I=(e,t)=>{let l;for(l=0===t?w:b,i=0;i<l.length;i++)for(let t=0;t<l[i].location.length;t++)if(-1!==e.indexOf(l[i].location[t]))return!0},B=(e,t)=>{const l=document.getElementById("fleet");return""===l.style.display?!(e.includes(0)||e.includes(10)&&e.includes(11)||e.includes(20)&&e.includes(21)||e.includes(30)&&e.includes(31)||e.includes(40)&&e.includes(41)||e.includes(50)&&e.includes(51)||e.includes(60)&&e.includes(61)||e.includes(70)&&e.includes(71)||e.includes(80)&&e.includes(81)||e.includes(90)&&e.includes(91)||e.includes(101)):"flex"===l.style.display?!(Math.min(...e)<1||Math.max(...e)>100):void 0},w=[],b=[],A=(e,t)=>{let l;l=0===e?w:b,0===l.length?l.push(t):0!==l.length&&(l.push(t),l.sort((function(e,t){return e.id-t.id})))},k=new l,C=new l,L=new t,v=new t;L.createGameboard(),v.createGameboard(),(()=>{const e=[[0,"Carrier",4],[1,"Battleship",3],[2,"Cruiser",2],[3,"Submarine",2],[4,"Destroyer",1]];for(let t=0;t<e.length;t++){let l=t,i=e[t][1],n=[];const s=Math.floor(2*Math.random())+1,d=Math.floor(100*Math.random())+1;if(n.push(d),1===s){for(let l=1;l<=e[t][2];l++)n.push(d+l);a(s,l,i,n)}if(2===s){for(let l=1;l<=e[t][2];l++)n.push(d+10*l);a(s,l,i,n)}}})(),document.querySelectorAll(".dragCell").forEach((e=>{e.addEventListener("mousedown",E)})),document.querySelectorAll(".dragShip").forEach((e=>{e.addEventListener("dragstart",f)})),(()=>{const e=document.getElementById("player"),t=document.getElementById("computer");for(let l=1;l<=100;l++){const i=document.createElement("div");i.classList.add("playCell"),i.setAttribute("data-playcell",l),e.appendChild(i);const n=document.createElement("div");n.classList.add("compCell"),n.setAttribute("data-compcell",l),t.appendChild(n),document.querySelectorAll(".compCell").forEach((e=>{e.addEventListener("click",k.playerAttack)}))}})()})();